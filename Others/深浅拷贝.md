# 深浅拷贝

### 浅拷贝

- object.assign()
- ...
- slice()
- concat()
- Array.from
- 自己实现

```javascript
let a = {
  age: { num: 2 }
};
let b = Object.assign({}, a);
console.log(b);
a.age.num = 0;
console.log(b);
```

```javascript
let a = {
  age: { num: 2 }
};
let b = { ...a };
console.log(b);
a.age.num = 0;
console.log(b);
```

```javascript
function shadowCopy(target) {
  if (typeof target !== "object") {
    throw new Error("参数错误");
  }
  if (target === null) return null;

  let copy = Array.isArray(target) ? [] : {};
  for (let key in target) {
    if (target.hasOwnProperty(key)) copy[key] = target[key];
  }

  return copy;
}
```

### 深拷贝

- JSON.parse(JSON.stringify(object))

```javascript
let a = {
  age: { num: 2 }
};
let b = JSON.parse(JSON.stringify(a));
console.log(b);
a.age.num = 0;
console.log(b);
```

- 优点
  - 简单
- 缺点
  - 会忽略 undefined
  - 会忽略 symbol
  - 不能序列化函数
  - 不能解决循环引用的对象

```javascript
let a = {
  name: undefined,
  age: 2,
  [Symbol("sex")]: 18,
  getAge: function() {
    return this.age;
  }
};
let b = JSON.parse(JSON.stringify(a));
console.log(b);
```

```javascript
let a = {
  age: 2,
  myself: null
};
a.myself = a;
JSON.parse(JSON.stringify(a));
// Converting circular structure to JSON
```

```javascript
```
